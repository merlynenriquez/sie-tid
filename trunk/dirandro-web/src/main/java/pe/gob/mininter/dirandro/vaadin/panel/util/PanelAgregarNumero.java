package pe.gob.mininter.dirandro.vaadin.panel.util;

import pe.gob.mininter.dirandro.model.Numero;
import pe.gob.mininter.dirandro.service.NumeroService;
import pe.gob.mininter.dirandro.vaadin.dialogs.AlertDialog;
import pe.gob.mininter.dirandro.vaadin.panel.parte.PanelRegistroParteTelefono;
import pe.gob.mininter.dirandro.vaadin.util.Injector;

import com.vaadin.annotations.AutoGenerated;
import com.vaadin.ui.Alignment;
import com.vaadin.ui.Button;
import com.vaadin.ui.Button.ClickEvent;
import com.vaadin.ui.Button.ClickListener;
import com.vaadin.ui.CustomComponent;
import com.vaadin.ui.HorizontalLayout;
import com.vaadin.ui.TextField;
import com.vaadin.ui.VerticalLayout;


public class PanelAgregarNumero extends CustomComponent implements ClickListener{

	/*- VaadinEditorProperties={"grid":"RegularGrid,20","showGrid":true,"snapToGrid":true,"snapToObject":true,"movingGuides":false,"snappingDistance":10} */

	@AutoGenerated
	private VerticalLayout mainLayout;
	@AutoGenerated
	private VerticalLayout pnlBody;
	@AutoGenerated
	private HorizontalLayout pnl1;
	@AutoGenerated
	private Button btnRegistrar;
	@AutoGenerated
	private TextField txtNumero;
	private static final long serialVersionUID = -7956048704434267119L;
	
	private PanelRegistroParteTelefono padre;
	private NumeroService numeroService;
	
	public PanelAgregarNumero() {
		buildMainLayout();
		numeroService = Injector.obtenerServicio(NumeroService.class);
		setCompositionRoot(mainLayout);
		postConstruct();
		debugId();
	}
	
	private void debugId(){
		
	}
	
	public void setPadre(PanelRegistroParteTelefono padre) {
		this.padre = padre;
	}

	public void postConstruct() {
		btnRegistrar.addListener((ClickListener) this);
	}

	@Override
	public void buttonClick(ClickEvent event) {
		if (event.getButton().equals(btnRegistrar)) {
			Numero numero = new Numero();
			numero.setNumero(txtNumero.getValue().toString());
			numeroService.crear(numero);
						
			AlertDialog alertDialog = new  AlertDialog("Registro del Numero", "Se ha registrado el número correctamente", "Aceptar", "400");
			getApplication().getMainWindow().addWindow(alertDialog);
			padre.actualizarNumeros(numero);
			getApplication().getMainWindow().removeWindow(getWindow());
		}
	}
	
	@AutoGenerated
	private VerticalLayout buildMainLayout() {
		// common part: create layout
		mainLayout = new VerticalLayout();
		mainLayout.setImmediate(false);
		mainLayout.setWidth("500px");
		mainLayout.setHeight("-1px");
		mainLayout.setMargin(false);
		
		// top-level component properties
		setWidth("500px");
		setHeight("-1px");
		
		// pnlBody
		pnlBody = buildPnlBody();
		mainLayout.addComponent(pnlBody);
		mainLayout.setComponentAlignment(pnlBody, new Alignment(20));
		
		return mainLayout;
	}

	@AutoGenerated
	private VerticalLayout buildPnlBody() {
		// common part: create layout
		pnlBody = new VerticalLayout();
		pnlBody.setStyleName("h2");
		pnlBody.setCaption("Registro del Equipo");
		pnlBody.setImmediate(false);
		pnlBody.setWidth("-1px");
		pnlBody.setHeight("-1px");
		pnlBody.setMargin(true);
		pnlBody.setSpacing(true);
		
		// pnl1
		pnl1 = buildPnl1();
		pnlBody.addComponent(pnl1);
		
		return pnlBody;
	}

	@AutoGenerated
	private HorizontalLayout buildPnl1() {
		// common part: create layout
		pnl1 = new HorizontalLayout();
		pnl1.setImmediate(false);
		pnl1.setWidth("-1px");
		pnl1.setHeight("-1px");
		pnl1.setMargin(false);
		pnl1.setSpacing(true);
		
		// txtNumero
		txtNumero = new TextField();
		txtNumero.setCaption("Numero Teléfonico");
		txtNumero.setImmediate(false);
		txtNumero.setWidth("200px");
		txtNumero.setHeight("-1px");
		pnl1.addComponent(txtNumero);
		
		// btnRegistrar
		btnRegistrar = new Button();
		btnRegistrar.setCaption("Grabar");
		btnRegistrar.setImmediate(true);
		btnRegistrar.setWidth("-1px");
		btnRegistrar.setHeight("-1px");
		pnl1.addComponent(btnRegistrar);
		pnl1.setComponentAlignment(btnRegistrar, new Alignment(10));
		
		return pnl1;
	}
}
